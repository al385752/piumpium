let aState={preload:preloadA,create:createA,update:updateA};class Owp{constructor(posX,posY,word,sprite){this.posX=posX,this.posY=posY,this.word=word,this.sprite=sprite}}const APARICION_OWP_Y=-50,TOTAL_OWPs=5;let owpsOnScreen,currentWave;const MAX_WAVES=10,OWP_ANCHOR_X=.5,OWP_ANCHOR_Y=.5,OWP_SPEED=10;let anguloOWP,activoOWP,typist,obj1,owps,ratio,owpWord,wordsUsed=[],text,points,correctLettersTyped,correctLettersTypedText,totalLettersTyped,owpsDeactivated,owpsDeactivatedText,timeElapsedText,currentWaveText,levelData,waveSpeedGeneral,spawn,gameTime;function preloadA(){game.load.image("typist","assets/imgs/X.png"),game.load.image("owp","assets/imgs/owp.png"),this.load.text("dictionaryA","assets/dictionaries/dictionaryA.json")}function createA(){let launchOWP;points=100,correctLettersTyped=0,owpsDeactivated=0,currentWave=-1,owpsOnScreen=0,spawn=!0,activoOWP=!1,levelData=JSON.parse(this.game.cache.getText("dictionaryA")),owpWord=levelData.words[Math.floor(24*Math.random())],wordsUsed=[],ratio=levelData.ratio[0].R,waveSpeedGeneral=levelData.speed[0].S,console.log(levelData),createTypist(),createOWP(),createHUD(),game.time.events.add(Phaser.Timer.SECOND*ratio,checkActivateOWP,this).loop=!0}function createTypist(){let posicionJugadorX=game.world.centerX,posicionJugadorY=game.world.height-50;typist=game.add.sprite(posicionJugadorX,posicionJugadorY,"typist"),typist.anchor.setTo(.5,.5),typist.scale.setTo(.05,.05),obj1=game.add.sprite(posicionJugadorX,posicionJugadorY,"typist"),obj1.anchor.setTo(.5,.5),obj1.scale.setTo(.05,.05),obj1.visible=!1}function createOWP(){owps=game.add.group(),owps.classType=Owp,owps.enableBody=!0,owps.createMultiple(5,"owp");for(let i=0;i<owps.length;i++);owps.callAll("anchor.setTo","anchor",.5,.5),owps.callAll("scale.setTo","scale",.1,.1),owps.setAll("checkWorldBounds",!0),timer=game.time.create(!1),timer.start()}function createHUD(){let lettersTypedTextX=5,owpsDeactivatedTextX=game.world.width/4,timeElapsedTextX=game.world.width/2,currentWaveTextX=game.world.width-5,allY=game.world.height-25,styleHUD={fontSize:"18px",fill:"#FFFFFF"};correctLettersTypedText=game.add.text(5,allY,"Letters: "+correctLettersTyped,styleHUD),owpsDeactivatedText=game.add.text(owpsDeactivatedTextX,allY,"Deactivated: "+owpsDeactivated,styleHUD),timeElapsedText=game.add.text(timeElapsedTextX,allY,"Time elapsed: "+Date.now(),styleHUD),currentWaveText=game.add.text(currentWaveTextX,allY,"Wave: "+(currentWave+1),styleHUD),currentWaveText.anchor.setTo(1,0)}function updateA(){gameTime=game.time.totalElapsedSeconds(),game.physics.arcade.overlap(owps,typist,killTypist,null,this),timeElapsedText.text="Time elapsed: "+gameTime}function killTypist(owps,typist){currentWave=1,gameTime=0,game.state.start("menuEnd")}function checkActivateOWP(){if(0==owpsOnScreen&&changeWave(),spawn){for(owpWord=levelData.words[Math.floor(24*Math.random())];wordsUsed.includes(owpWord);)owpWord=levelData.words[Math.floor(24*Math.random())];wordsUsed.push(owpWord),console.log(wordsUsed),activateOWP(waveSpeedGeneral,owpWord),owpsOnScreen+=1,owpsOnScreen>=5&&(spawn=!1)}}function activateOWP(waveSpeed,newWord){let owp=owps.getFirstExists(!1);if(owp){console.log(newWord);let gameWorldWidth=game.world.width,owpWidth=owp.body.width,spawnWidth=gameWorldWidth-owpWidth,spawnerPoint,exactPointSpawn=owpWidth/2+Math.floor(Math.random()*spawnWidth);owp.reset(exactPointSpawn,0),text=game.add.text(owp.x-40,owp.y,newWord,{font:"15px Arial",fill:"#FFFFFF"}),text.anchor.setTo(.5),game.physics.arcade.enable(text),obj1.x=obj1.x+(100*Math.random()-50),game.physics.arcade.moveToObject(owp,obj1,waveSpeed),game.physics.arcade.moveToObject(text,obj1,waveSpeed),obj1.x=game.world.centerX,console.log(ratio)}}function resetOWP(item){console.log("muerto"),owpsOnScreen-=1,console.log("quedan: "+owpsOnScreen),item.kill()}function changeWave(){console.log("entra"),10==currentWave?game.state.start("menuEnd"):(spawn=!0,currentWave+=1,currentWaveText.text="Wave: "+(currentWave+1),waveSpeedGeneral=levelData.speed[currentWave].S,ratio=levelData.ratio[currentWave].R,console.log(waveSpeedGeneral))}